import type { BugBountyProgram, BountyPlatform, BountyStatus } from './types'

export interface BugBountyCategory {
  id: string
  title: string
  description: string
  programs: BugBountyProgram[]
}

export const bugBountyPrograms: BugBountyCategory[] = [
  {
    id: 'ai-native',
    title: 'AI-Native Companies',
    description: 'Bug bounty programs from companies primarily focused on AI/ML products',
    programs: [
      {
        id: 'bb-001',
        title: 'OpenAI Bug Bounty',
        description: 'Security research program for ChatGPT, GPT APIs, DALL-E, and other OpenAI products. Focuses on API vulnerabilities, authentication bypasses, and safety/alignment issues.',
        company: 'OpenAI',
        platform: 'bugcrowd' as BountyPlatform,
        url: 'https://bugcrowd.com/openai',
        status: 'active' as BountyStatus,
        maxReward: 20000,
        rewardRange: '$200 - $20,000',
        currency: 'USD',
        scope: ['api.openai.com', 'chat.openai.com', 'platform.openai.com', 'labs.openai.com'],
        aiSystemsInScope: ['ChatGPT', 'GPT-4 API', 'DALL-E', 'Whisper API', 'Embeddings API'],
        excludedVulnerabilities: ['Model jailbreaking', 'Prompt injection without security impact', 'Social engineering'],
        responseTime: '1-3 business days',
        launched: '2023-04',
      },
      {
        id: 'bb-002',
        title: 'Anthropic Bug Bounty',
        description: 'Security research for Claude AI assistant and related infrastructure. Covers API security, authentication, and constitutional AI safety mechanisms.',
        company: 'Anthropic',
        platform: 'hackerone' as BountyPlatform,
        url: 'https://hackerone.com/anthropic',
        status: 'active' as BountyStatus,
        maxReward: 25000,
        rewardRange: '$500 - $25,000',
        currency: 'USD',
        scope: ['claude.ai', 'api.anthropic.com', 'console.anthropic.com'],
        aiSystemsInScope: ['Claude 3', 'Claude API', 'Claude Enterprise'],
        excludedVulnerabilities: ['Jailbreaking attempts', 'Prompt leaks without data exposure', 'Rate limiting issues'],
        responseTime: '2-5 business days',
        launched: '2023-07',
      },
      {
        id: 'bb-003',
        title: 'Google DeepMind VRP',
        description: 'Vulnerability Reward Program covering DeepMind AI products including Gemini, AlphaFold, and research infrastructure.',
        company: 'Google DeepMind',
        platform: 'direct' as BountyPlatform,
        url: 'https://bughunters.google.com/about/rules/6625378258649088/ai-bug-hunters-rules',
        status: 'active' as BountyStatus,
        maxReward: 31337,
        rewardRange: '$500 - $31,337',
        currency: 'USD',
        scope: ['gemini.google.com', 'aistudio.google.com', 'deepmind.google'],
        aiSystemsInScope: ['Gemini', 'Gemini API', 'AI Studio', 'Vertex AI'],
        excludedVulnerabilities: ['Theoretical attacks without PoC', 'Known limitations', 'Social engineering'],
        responseTime: '1-2 business days',
        launched: '2024-01',
      },
      {
        id: 'bb-004',
        title: 'Hugging Face Bug Bounty',
        description: 'Security program for the Hugging Face Hub, Inference API, Spaces, and model hosting infrastructure.',
        company: 'Hugging Face',
        platform: 'huntr' as BountyPlatform,
        url: 'https://huntr.com/bounties/huggingface',
        status: 'active' as BountyStatus,
        maxReward: 10000,
        rewardRange: '$100 - $10,000',
        currency: 'USD',
        scope: ['huggingface.co', 'api-inference.huggingface.co', '*.hf.space'],
        aiSystemsInScope: ['Hub', 'Inference API', 'Spaces', 'Transformers library'],
        excludedVulnerabilities: ['Model behavior issues', 'Dataset content', 'Third-party model vulnerabilities'],
        responseTime: '3-5 business days',
        launched: '2023-02',
      },
      {
        id: 'bb-005',
        title: 'Stability AI Security',
        description: 'Bug bounty for Stable Diffusion products, DreamStudio, and API infrastructure.',
        company: 'Stability AI',
        platform: 'hackerone' as BountyPlatform,
        url: 'https://hackerone.com/stability_ai',
        status: 'active' as BountyStatus,
        maxReward: 5000,
        rewardRange: '$100 - $5,000',
        currency: 'USD',
        scope: ['stability.ai', 'dreamstudio.ai', 'api.stability.ai'],
        aiSystemsInScope: ['Stable Diffusion', 'DreamStudio', 'Stability API'],
        excludedVulnerabilities: ['Content policy violations', 'Image generation quality', 'Model bias'],
        responseTime: '5-7 business days',
        launched: '2023-01',
      },
      {
        id: 'bb-006',
        title: 'Cohere Security Research',
        description: 'Security research program for Cohere NLP APIs and enterprise AI products.',
        company: 'Cohere',
        platform: 'hackerone' as BountyPlatform,
        url: 'https://hackerone.com/cohere',
        status: 'active' as BountyStatus,
        maxReward: 10000,
        rewardRange: '$250 - $10,000',
        currency: 'USD',
        scope: ['cohere.com', 'api.cohere.ai', 'dashboard.cohere.com'],
        aiSystemsInScope: ['Command', 'Embed', 'Rerank', 'Generate API'],
        excludedVulnerabilities: ['Model output quality', 'Prompt engineering', 'Rate limits'],
        responseTime: '3-5 business days',
        launched: '2023-06',
      },
    ],
  },
  {
    id: 'tech-giants',
    title: 'Tech Giants AI Programs',
    description: 'AI-focused bug bounty programs from major technology companies',
    programs: [
      {
        id: 'bb-007',
        title: 'Microsoft AI Bug Bounty',
        description: 'Dedicated AI security research for Copilot, Azure AI, and Microsoft AI services. Includes specific categories for prompt injection and AI safety.',
        company: 'Microsoft',
        platform: 'direct' as BountyPlatform,
        url: 'https://www.microsoft.com/en-us/msrc/bounty-ai',
        status: 'active' as BountyStatus,
        maxReward: 15000,
        rewardRange: '$2,000 - $15,000',
        currency: 'USD',
        scope: ['copilot.microsoft.com', 'azure.microsoft.com/ai', 'bing.com/chat'],
        aiSystemsInScope: ['Microsoft Copilot', 'Azure OpenAI Service', 'Bing Chat', 'Azure AI Studio'],
        excludedVulnerabilities: ['Training data extraction', 'Model weight extraction', 'Jailbreaking without impact'],
        responseTime: '1-2 business days',
        launched: '2023-10',
      },
      {
        id: 'bb-008',
        title: 'Meta AI Security',
        description: 'Security program covering LLaMA models, AI infrastructure, and Meta AI products.',
        company: 'Meta',
        platform: 'hackerone' as BountyPlatform,
        url: 'https://hackerone.com/facebook',
        status: 'active' as BountyStatus,
        maxReward: 50000,
        rewardRange: '$500 - $50,000',
        currency: 'USD',
        scope: ['meta.ai', 'ai.meta.com', 'llama.meta.com'],
        aiSystemsInScope: ['Meta AI', 'LLaMA', 'AI Studio', 'Imagine'],
        excludedVulnerabilities: ['Open source model issues', 'Research paper reproduction', 'Content moderation'],
        responseTime: '1-3 business days',
        launched: '2024-01',
      },
      {
        id: 'bb-009',
        title: 'Amazon AWS AI/ML',
        description: 'Security research for AWS AI/ML services including SageMaker, Bedrock, and AI infrastructure.',
        company: 'Amazon',
        platform: 'hackerone' as BountyPlatform,
        url: 'https://hackerone.com/amazonwebservices',
        status: 'active' as BountyStatus,
        maxReward: 25000,
        rewardRange: '$500 - $25,000',
        currency: 'USD',
        scope: ['aws.amazon.com/sagemaker', 'aws.amazon.com/bedrock', 'q.aws'],
        aiSystemsInScope: ['Amazon Bedrock', 'SageMaker', 'Amazon Q', 'CodeWhisperer'],
        excludedVulnerabilities: ['Model performance', 'Third-party model issues', 'Cost optimization'],
        responseTime: '2-5 business days',
        launched: '2023-09',
      },
      {
        id: 'bb-010',
        title: 'Apple Machine Learning',
        description: 'Security research for Apple ML frameworks, Siri, and on-device AI features.',
        company: 'Apple',
        platform: 'direct' as BountyPlatform,
        url: 'https://security.apple.com/bounty/',
        status: 'active' as BountyStatus,
        maxReward: 250000,
        rewardRange: '$5,000 - $250,000',
        currency: 'USD',
        scope: ['Apple ML', 'Siri', 'Core ML', 'Apple Intelligence'],
        aiSystemsInScope: ['Siri', 'Apple Intelligence', 'Core ML', 'Create ML'],
        excludedVulnerabilities: ['Voice recognition quality', 'Model performance', 'Feature requests'],
        responseTime: '3-7 business days',
        launched: '2019-08',
      },
    ],
  },
  {
    id: 'ai-tools',
    title: 'AI Tools & Platforms',
    description: 'Bug bounties for AI development tools, platforms, and infrastructure',
    programs: [
      {
        id: 'bb-011',
        title: 'LangChain Security',
        description: 'Security research for LangChain framework and LangSmith platform.',
        company: 'LangChain',
        platform: 'huntr' as BountyPlatform,
        url: 'https://huntr.com/bounties/langchain',
        status: 'active' as BountyStatus,
        maxReward: 5000,
        rewardRange: '$100 - $5,000',
        currency: 'USD',
        scope: ['langchain.com', 'smith.langchain.com', 'GitHub repositories'],
        aiSystemsInScope: ['LangChain', 'LangSmith', 'LangServe', 'LangGraph'],
        excludedVulnerabilities: ['User-provided prompts', 'Third-party integration issues', 'Documentation errors'],
        responseTime: '5-10 business days',
        launched: '2023-08',
      },
      {
        id: 'bb-012',
        title: 'Weights & Biases',
        description: 'Bug bounty for W&B ML experiment tracking and model registry platform.',
        company: 'Weights & Biases',
        platform: 'hackerone' as BountyPlatform,
        url: 'https://hackerone.com/wandb',
        status: 'active' as BountyStatus,
        maxReward: 7500,
        rewardRange: '$150 - $7,500',
        currency: 'USD',
        scope: ['wandb.ai', 'api.wandb.ai', 'wandb.run'],
        aiSystemsInScope: ['Experiment Tracking', 'Model Registry', 'Weave', 'Launch'],
        excludedVulnerabilities: ['Self-XSS', 'Missing best practices', 'Theoretical issues'],
        responseTime: '3-5 business days',
        launched: '2022-11',
      },
      {
        id: 'bb-013',
        title: 'MLflow Security',
        description: 'Open source ML lifecycle platform security through Databricks program.',
        company: 'Databricks',
        platform: 'hackerone' as BountyPlatform,
        url: 'https://hackerone.com/databricks',
        status: 'active' as BountyStatus,
        maxReward: 10000,
        rewardRange: '$200 - $10,000',
        currency: 'USD',
        scope: ['mlflow.org', 'databricks.com/mlflow'],
        aiSystemsInScope: ['MLflow', 'Model Serving', 'Feature Store', 'Unity Catalog'],
        excludedVulnerabilities: ['Open source misuse', 'Configuration issues', 'Performance'],
        responseTime: '3-7 business days',
        launched: '2023-03',
      },
      {
        id: 'bb-014',
        title: 'Replicate',
        description: 'Security program for Replicate model hosting and inference platform.',
        company: 'Replicate',
        platform: 'hackerone' as BountyPlatform,
        url: 'https://hackerone.com/replicate',
        status: 'active' as BountyStatus,
        maxReward: 5000,
        rewardRange: '$100 - $5,000',
        currency: 'USD',
        scope: ['replicate.com', 'api.replicate.com', 'r8.im'],
        aiSystemsInScope: ['Model Hosting', 'Predictions API', 'Deployments', 'Training'],
        excludedVulnerabilities: ['Model outputs', 'Third-party model issues', 'Rate limits'],
        responseTime: '5-7 business days',
        launched: '2023-05',
      },
    ],
  },
  {
    id: 'security-ai',
    title: 'AI Security Companies',
    description: 'Bug bounties from companies focused on AI security products',
    programs: [
      {
        id: 'bb-015',
        title: 'Lakera Guard',
        description: 'Security research for Lakera AI security platform and prompt injection detection.',
        company: 'Lakera',
        platform: 'direct' as BountyPlatform,
        url: 'https://www.lakera.ai/security',
        status: 'active' as BountyStatus,
        maxReward: 5000,
        rewardRange: '$200 - $5,000',
        currency: 'USD',
        scope: ['lakera.ai', 'api.lakera.ai', 'platform.lakera.ai'],
        aiSystemsInScope: ['Lakera Guard', 'Gandalf', 'Red', 'ChainGuard'],
        excludedVulnerabilities: ['Detection bypasses with no impact', 'Rate limiting', 'UX issues'],
        responseTime: '3-5 business days',
        launched: '2023-09',
      },
      {
        id: 'bb-016',
        title: 'Protect AI',
        description: 'Bug bounty for ML security tools including ModelScan and NB Defense.',
        company: 'Protect AI',
        platform: 'huntr' as BountyPlatform,
        url: 'https://huntr.com/bounties/protectai',
        status: 'active' as BountyStatus,
        maxReward: 3000,
        rewardRange: '$100 - $3,000',
        currency: 'USD',
        scope: ['GitHub repositories', 'protectai.com'],
        aiSystemsInScope: ['ModelScan', 'NB Defense', 'Guardian', 'Rebuff'],
        excludedVulnerabilities: ['Open source configuration', 'Documentation', 'Non-security bugs'],
        responseTime: '5-10 business days',
        launched: '2023-06',
      },
    ],
  },
  {
    id: 'enterprise-ai',
    title: 'Enterprise AI Applications',
    description: 'Bug bounties from companies with significant AI-powered products',
    programs: [
      {
        id: 'bb-017',
        title: 'Notion AI',
        description: 'Security research for Notion AI writing assistant and AI-powered features.',
        company: 'Notion',
        platform: 'hackerone' as BountyPlatform,
        url: 'https://hackerone.com/notion',
        status: 'active' as BountyStatus,
        maxReward: 10000,
        rewardRange: '$200 - $10,000',
        currency: 'USD',
        scope: ['notion.so', 'api.notion.com'],
        aiSystemsInScope: ['Notion AI', 'AI Autofill', 'AI Summarize', 'Q&A'],
        excludedVulnerabilities: ['AI output quality', 'Content generation', 'Feature limitations'],
        responseTime: '2-5 business days',
        launched: '2023-02',
      },
      {
        id: 'bb-018',
        title: 'Canva AI',
        description: 'Bug bounty covering Magic Design, Text to Image, and AI-powered design tools.',
        company: 'Canva',
        platform: 'bugcrowd' as BountyPlatform,
        url: 'https://bugcrowd.com/canva',
        status: 'active' as BountyStatus,
        maxReward: 20000,
        rewardRange: '$150 - $20,000',
        currency: 'USD',
        scope: ['canva.com', 'canva.dev'],
        aiSystemsInScope: ['Magic Design', 'Magic Write', 'Magic Edit', 'Text to Image'],
        excludedVulnerabilities: ['Design quality', 'Content moderation', 'Generation failures'],
        responseTime: '3-5 business days',
        launched: '2023-04',
      },
      {
        id: 'bb-019',
        title: 'Grammarly AI',
        description: 'Security research for Grammarly writing assistant and GrammarlyGO AI features.',
        company: 'Grammarly',
        platform: 'hackerone' as BountyPlatform,
        url: 'https://hackerone.com/grammarly',
        status: 'active' as BountyStatus,
        maxReward: 15000,
        rewardRange: '$250 - $15,000',
        currency: 'USD',
        scope: ['grammarly.com', 'app.grammarly.com', 'browser extensions'],
        aiSystemsInScope: ['GrammarlyGO', 'Writing Assistant', 'Tone Detection', 'Style Guide'],
        excludedVulnerabilities: ['Writing suggestions', 'Grammar accuracy', 'Language coverage'],
        responseTime: '2-4 business days',
        launched: '2022-06',
      },
      {
        id: 'bb-020',
        title: 'Slack AI',
        description: 'Security program for Slack AI features including summaries and search.',
        company: 'Salesforce/Slack',
        platform: 'hackerone' as BountyPlatform,
        url: 'https://hackerone.com/slack',
        status: 'active' as BountyStatus,
        maxReward: 15000,
        rewardRange: '$200 - $15,000',
        currency: 'USD',
        scope: ['slack.com', 'api.slack.com', 'slack enterprise'],
        aiSystemsInScope: ['Slack AI', 'Channel Summaries', 'AI Search', 'Huddle Notes'],
        excludedVulnerabilities: ['Summary accuracy', 'Search relevance', 'AI availability'],
        responseTime: '2-5 business days',
        launched: '2024-02',
      },
    ],
  },
]

// Helper functions
export const getAllPrograms = (): BugBountyProgram[] => {
  return bugBountyPrograms.flatMap(category => category.programs)
}

export const getProgramById = (id: string): BugBountyProgram | undefined => {
  return getAllPrograms().find(program => program.id === id)
}

export const getProgramsByPlatform = (platform: BountyPlatform): BugBountyProgram[] => {
  return getAllPrograms().filter(program => program.platform === platform)
}

export const getProgramsByStatus = (status: BountyStatus): BugBountyProgram[] => {
  return getAllPrograms().filter(program => program.status === status)
}

export const getActivePrograms = (): BugBountyProgram[] => {
  return getProgramsByStatus('active')
}

export const getProgramsByMinReward = (minReward: number): BugBountyProgram[] => {
  return getAllPrograms().filter(program => program.maxReward >= minReward)
}

// Stats
export const bountyStats = {
  totalPrograms: getAllPrograms().length,
  activePrograms: getActivePrograms().length,
  avgMaxReward: Math.round(getAllPrograms().reduce((sum, p) => sum + p.maxReward, 0) / getAllPrograms().length),
  maxPossibleReward: Math.max(...getAllPrograms().map(p => p.maxReward)),
  byPlatform: {
    hackerone: getProgramsByPlatform('hackerone').length,
    bugcrowd: getProgramsByPlatform('bugcrowd').length,
    huntr: getProgramsByPlatform('huntr').length,
    direct: getProgramsByPlatform('direct').length,
  },
  categories: bugBountyPrograms.length,
}
