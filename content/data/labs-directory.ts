import type { Lab, Difficulty, LabType, LabEnvironment } from './types'

export interface LabCategory {
  id: string
  title: string
  description: string
  icon: string
  labs: Lab[]
}

export const labsDirectory: LabCategory[] = [
  {
    id: 'prompt-injection',
    title: 'Prompt Injection & Jailbreaking',
    description: 'Learn to identify and exploit prompt injection vulnerabilities',
    icon: 'Terminal',
    labs: [
      {
        id: 'lab-ctf-001',
        title: 'Gandalf by Lakera',
        description: 'Classic LLM CTF where you must extract a secret password through escalating prompt injection techniques across 7 increasingly difficult levels.',
        provider: 'Lakera',
        url: 'https://gandalf.lakera.ai/',
        difficulty: 'beginner' as Difficulty,
        type: 'ctf' as LabType,
        environment: 'web' as LabEnvironment,
        estimatedTime: '1-2 hours',
        categories: ['Prompt Injection', 'Jailbreaking'],
        owaspMapping: ['LLM01'],
        features: ['Progressive difficulty', 'Instant feedback', 'No setup required'],
        isFree: true,
        isActive: true,
        dateAdded: '2024-01-01',
      },
      {
        id: 'lab-ctf-002',
        title: 'Gandalf Agent Breaker',
        description: 'Advanced version of Gandalf focusing on AI agent security. Exploit tool-using agents and multi-step reasoning vulnerabilities.',
        provider: 'Lakera',
        url: 'https://gandalf.lakera.ai/agent-breaker',
        difficulty: 'advanced' as Difficulty,
        type: 'ctf' as LabType,
        environment: 'web' as LabEnvironment,
        estimatedTime: '2-4 hours',
        categories: ['Agent Security', 'Tool Abuse'],
        owaspMapping: ['LLM01', 'LLM06'],
        features: ['Agent-specific attacks', 'Tool manipulation', 'Multi-step exploits'],
        isFree: true,
        isActive: true,
        dateAdded: '2024-06-01',
      },
      {
        id: 'lab-ctf-003',
        title: 'Prompt Airlines (Wiz)',
        description: 'Navigate through a fictional airline booking system to exploit LLM vulnerabilities. Great for understanding real-world application contexts.',
        provider: 'Wiz',
        url: 'https://promptairlines.com/',
        difficulty: 'intermediate' as Difficulty,
        type: 'ctf' as LabType,
        environment: 'web' as LabEnvironment,
        estimatedTime: '2-3 hours',
        categories: ['Prompt Injection', 'Business Logic'],
        owaspMapping: ['LLM01', 'LLM02'],
        features: ['Realistic scenario', 'Multiple attack vectors', 'Hints available'],
        isFree: true,
        isActive: true,
        dateAdded: '2024-03-01',
      },
      {
        id: 'lab-ctf-004',
        title: 'Tensor Trust',
        description: 'Competitive prompt injection arena where you both attack other players\' prompts and defend your own. Learn offense and defense simultaneously.',
        provider: 'Tensor Trust',
        url: 'https://tensortrust.ai/',
        difficulty: 'intermediate' as Difficulty,
        type: 'ctf' as LabType,
        environment: 'web' as LabEnvironment,
        estimatedTime: '2-4 hours',
        categories: ['Prompt Injection', 'Defense'],
        owaspMapping: ['LLM01'],
        features: ['PvP competition', 'Leaderboard', 'Attack and defend'],
        isFree: true,
        isActive: true,
        dateAdded: '2024-02-01',
      },
      {
        id: 'lab-ctf-005',
        title: 'GPT Prompt Attack',
        description: 'Simple beginner-friendly prompt injection challenges. Perfect for those just starting their AI security journey.',
        provider: '43z',
        url: 'https://gpa.43z.one/',
        difficulty: 'beginner' as Difficulty,
        type: 'ctf' as LabType,
        environment: 'web' as LabEnvironment,
        estimatedTime: '30 min - 1 hour',
        categories: ['Prompt Injection'],
        owaspMapping: ['LLM01'],
        features: ['Beginner-friendly', 'Quick challenges', 'No signup required'],
        isFree: true,
        isActive: true,
        dateAdded: '2024-01-15',
      },
      {
        id: 'lab-ctf-006',
        title: 'HackMerlin',
        description: 'Interactive prompt injection challenges with a fantasy theme. Progress through different realms by defeating AI guardians.',
        provider: 'HackMerlin',
        url: 'https://hackmerlin.io/',
        difficulty: 'beginner' as Difficulty,
        type: 'ctf' as LabType,
        environment: 'web' as LabEnvironment,
        estimatedTime: '1-2 hours',
        categories: ['Prompt Injection', 'Jailbreaking'],
        owaspMapping: ['LLM01'],
        features: ['Gamified learning', 'Multiple levels', 'Story-driven'],
        isFree: true,
        isActive: true,
        dateAdded: '2024-04-01',
      },
      {
        id: 'lab-ctf-007',
        title: 'Immersive Labs Prompt Injection',
        description: 'Professional training platform with guided prompt injection exercises. Includes detailed explanations and learning objectives.',
        provider: 'Immersive Labs',
        url: 'https://prompting.ai.immersivelabs.com/',
        difficulty: 'beginner' as Difficulty,
        type: 'workshop' as LabType,
        environment: 'web' as LabEnvironment,
        estimatedTime: '2-3 hours',
        categories: ['Prompt Injection'],
        owaspMapping: ['LLM01'],
        features: ['Structured learning', 'Progress tracking', 'Certificates'],
        isFree: true,
        isActive: true,
        dateAdded: '2024-02-15',
      },
    ],
  },
  {
    id: 'comprehensive-platforms',
    title: 'Comprehensive Testing Platforms',
    description: 'Full-featured platforms covering multiple vulnerability types',
    icon: 'FlaskConical',
    labs: [
      {
        id: 'lab-platform-001',
        title: 'Dreadnode Crucible',
        description: 'Advanced AI security testing platform with real-world scenarios. Covers prompt injection, data extraction, and more.',
        provider: 'Dreadnode',
        url: 'https://platform.dreadnode.io/crucible',
        difficulty: 'advanced' as Difficulty,
        type: 'challenge' as LabType,
        environment: 'web' as LabEnvironment,
        estimatedTime: '4-8 hours',
        categories: ['Prompt Injection', 'Data Extraction', 'Jailbreaking'],
        owaspMapping: ['LLM01', 'LLM02', 'LLM07'],
        features: ['Real-world scenarios', 'Leaderboard', 'Community'],
        isFree: true,
        isActive: true,
        dateAdded: '2024-05-01',
      },
      {
        id: 'lab-platform-002',
        title: 'HackTheAgent',
        description: 'Comprehensive platform for testing AI agent vulnerabilities. Includes tool abuse, privilege escalation, and memory attacks.',
        provider: 'HackTheAgent',
        url: 'https://hacktheagent.com/',
        difficulty: 'intermediate' as Difficulty,
        type: 'challenge' as LabType,
        environment: 'web' as LabEnvironment,
        estimatedTime: '4-6 hours',
        categories: ['Agent Security', 'Tool Abuse', 'Privilege Escalation'],
        owaspMapping: ['LLM06', 'LLM08'],
        features: ['Agent-focused', 'Multiple attack vectors', 'Documentation'],
        isFree: true,
        isActive: true,
        dateAdded: '2024-06-15',
      },
      {
        id: 'lab-platform-003',
        title: 'PortSwigger LLM Labs',
        description: 'High-quality LLM security labs from the creators of Burp Suite. Professional-grade training with detailed solutions.',
        provider: 'PortSwigger',
        url: 'https://portswigger.net/web-security/llm-attacks',
        difficulty: 'intermediate' as Difficulty,
        type: 'workshop' as LabType,
        environment: 'web' as LabEnvironment,
        estimatedTime: '4-8 hours',
        categories: ['Prompt Injection', 'Data Extraction', 'SSRF'],
        owaspMapping: ['LLM01', 'LLM02', 'LLM06'],
        features: ['Professional quality', 'Detailed explanations', 'Community solutions'],
        isFree: true,
        isActive: true,
        dateAdded: '2024-01-20',
      },
      {
        id: 'lab-platform-004',
        title: 'Gray Swan AI Arena',
        description: 'Competition-style AI security challenges with cash prizes. Test your skills against other researchers.',
        provider: 'Gray Swan',
        url: 'https://app.grayswan.ai/arena',
        difficulty: 'advanced' as Difficulty,
        type: 'challenge' as LabType,
        environment: 'web' as LabEnvironment,
        estimatedTime: 'Ongoing',
        categories: ['Jailbreaking', 'Safety Bypass'],
        owaspMapping: ['LLM01', 'LLM09'],
        features: ['Cash prizes', 'Leaderboard', 'Real AI models'],
        isFree: true,
        isActive: true,
        dateAdded: '2024-07-01',
      },
      {
        id: 'lab-platform-005',
        title: 'RedTeam Arena',
        description: 'Crowdsourced red teaming platform where you can test LLMs and earn rewards for finding vulnerabilities.',
        provider: 'RedTeam Arena',
        url: 'https://redarena.ai/',
        difficulty: 'intermediate' as Difficulty,
        type: 'challenge' as LabType,
        environment: 'web' as LabEnvironment,
        estimatedTime: 'Ongoing',
        categories: ['Jailbreaking', 'Safety Testing'],
        owaspMapping: ['LLM01', 'LLM09'],
        features: ['Community-driven', 'Multiple models', 'Rewards'],
        isFree: true,
        isActive: true,
        dateAdded: '2024-08-01',
      },
    ],
  },
  {
    id: 'rag-data-extraction',
    title: 'RAG & Data Extraction',
    description: 'Labs focused on RAG security and data exfiltration techniques',
    icon: 'Database',
    labs: [
      {
        id: 'lab-rag-001',
        title: 'MyLLMBank',
        description: 'Practice extracting sensitive financial data from a RAG-powered banking assistant. Learn about indirect prompt injection.',
        provider: 'Arcanum',
        url: 'https://myllmbank.com/',
        difficulty: 'intermediate' as Difficulty,
        type: 'ctf' as LabType,
        environment: 'web' as LabEnvironment,
        estimatedTime: '2-3 hours',
        categories: ['RAG Attacks', 'Data Extraction'],
        owaspMapping: ['LLM01', 'LLM02', 'LLM08'],
        features: ['Financial scenario', 'RAG exploitation', 'Realistic data'],
        isFree: true,
        isActive: true,
        dateAdded: '2024-04-15',
      },
      {
        id: 'lab-rag-002',
        title: 'MyLLMDoc',
        description: 'Attack a document-processing LLM system. Extract confidential information from uploaded documents through the AI.',
        provider: 'Arcanum',
        url: 'https://myllmdoc.com/',
        difficulty: 'advanced' as Difficulty,
        type: 'ctf' as LabType,
        environment: 'web' as LabEnvironment,
        estimatedTime: '2-4 hours',
        categories: ['RAG Attacks', 'Document Poisoning'],
        owaspMapping: ['LLM01', 'LLM02', 'LLM08'],
        features: ['Document context', 'Indirect injection', 'Multiple vectors'],
        isFree: true,
        isActive: true,
        dateAdded: '2024-05-15',
      },
    ],
  },
  {
    id: 'self-hosted',
    title: 'Self-Hosted Labs',
    description: 'Labs you can run locally for deeper learning and customization',
    icon: 'Server',
    labs: [
      {
        id: 'lab-self-001',
        title: 'OWASP FinBot CTF',
        description: 'Official OWASP vulnerable LLM application covering all OWASP LLM Top 10 vulnerabilities in a financial context.',
        provider: 'OWASP',
        url: 'https://owasp-finbot-ctf-demo.onrender.com/',
        difficulty: 'intermediate' as Difficulty,
        type: 'ctf' as LabType,
        environment: 'docker' as LabEnvironment,
        estimatedTime: '4-6 hours',
        categories: ['OWASP Top 10', 'Financial'],
        owaspMapping: ['LLM01', 'LLM02', 'LLM03', 'LLM04', 'LLM05', 'LLM06', 'LLM07', 'LLM08', 'LLM09', 'LLM10'],
        githubUrl: 'https://github.com/OWASP-ASI/finbot-ctf-demo',
        features: ['Full OWASP coverage', 'Docker deployment', 'Open source'],
        isFree: true,
        isActive: true,
        dateAdded: '2024-03-15',
      },
      {
        id: 'lab-self-002',
        title: 'Broken LLM Integration App',
        description: 'Intentionally vulnerable application demonstrating common LLM integration mistakes. Great for learning secure coding practices.',
        provider: 'Community',
        url: 'https://github.com/13o-bbr-bbq/Broken_LLM_Integration_App',
        difficulty: 'beginner' as Difficulty,
        type: 'sandbox' as LabType,
        environment: 'docker' as LabEnvironment,
        estimatedTime: '2-4 hours',
        categories: ['Integration Vulnerabilities', 'Secure Coding'],
        owaspMapping: ['LLM01', 'LLM05', 'LLM06'],
        githubUrl: 'https://github.com/13o-bbr-bbq/Broken_LLM_Integration_App',
        features: ['Open source', 'Learning focused', 'Good documentation'],
        isFree: true,
        isActive: true,
        dateAdded: '2024-02-20',
      },
      {
        id: 'lab-self-003',
        title: 'PwnGPT CTF',
        description: 'Python-based CTF environment for practicing prompt injection attacks. Easy to set up and customize.',
        provider: 'Community',
        url: 'https://github.com/c-goosen/ai-prompt-ctf',
        difficulty: 'intermediate' as Difficulty,
        type: 'ctf' as LabType,
        environment: 'docker' as LabEnvironment,
        estimatedTime: '2-3 hours',
        categories: ['Prompt Injection'],
        owaspMapping: ['LLM01'],
        githubUrl: 'https://github.com/c-goosen/ai-prompt-ctf',
        features: ['Python-based', 'Customizable', 'Good for workshops'],
        isFree: true,
        isActive: true,
        dateAdded: '2024-01-25',
      },
      {
        id: 'lab-self-004',
        title: 'PromptMe OWASP',
        description: 'Comprehensive vulnerable LLM application aligned with OWASP LLM Top 10. Includes both challenges and solutions.',
        provider: 'Community',
        url: 'https://github.com/R3dShad0w7/PromptMe',
        difficulty: 'intermediate' as Difficulty,
        type: 'sandbox' as LabType,
        environment: 'docker' as LabEnvironment,
        estimatedTime: '4-6 hours',
        categories: ['OWASP Top 10'],
        owaspMapping: ['LLM01', 'LLM02', 'LLM03', 'LLM06', 'LLM07'],
        githubUrl: 'https://github.com/R3dShad0w7/PromptMe',
        features: ['OWASP aligned', 'Solutions included', 'Active development'],
        isFree: true,
        isActive: true,
        dateAdded: '2024-04-01',
      },
      {
        id: 'lab-self-005',
        title: 'Auto Parts CTF',
        description: 'CTF scenario involving an auto parts shop chatbot. Practice customer service AI exploitation.',
        provider: 'Arcanum',
        url: 'https://github.com/Arcanum-Sec/MyLLMAuto',
        difficulty: 'intermediate' as Difficulty,
        type: 'ctf' as LabType,
        environment: 'docker' as LabEnvironment,
        estimatedTime: '2-3 hours',
        categories: ['Prompt Injection', 'Business Logic'],
        owaspMapping: ['LLM01', 'LLM02'],
        githubUrl: 'https://github.com/Arcanum-Sec/MyLLMAuto',
        features: ['Business context', 'Realistic scenario', 'Docker-based'],
        isFree: true,
        isActive: true,
        dateAdded: '2024-05-01',
      },
      {
        id: 'lab-self-006',
        title: 'Professional Secure AI Bot',
        description: 'Test your skills against a hardened AI assistant. Learn what good defenses look like and how to bypass them.',
        provider: 'NSIDE',
        url: 'https://github.com/NSIDE-ATTACK-LOGIC/Professional-Secure-AI-Bot',
        difficulty: 'advanced' as Difficulty,
        type: 'challenge' as LabType,
        environment: 'docker' as LabEnvironment,
        estimatedTime: '3-5 hours',
        categories: ['Defense Bypass', 'Hardened Systems'],
        owaspMapping: ['LLM01'],
        githubUrl: 'https://github.com/NSIDE-ATTACK-LOGIC/Professional-Secure-AI-Bot',
        features: ['Hardened target', 'Defense learning', 'Professional quality'],
        isFree: true,
        isActive: true,
        dateAdded: '2024-06-01',
      },
    ],
  },
]

// Helper functions
export const getAllLabs = (): Lab[] => {
  return labsDirectory.flatMap(category => category.labs)
}

export const getLabById = (id: string): Lab | undefined => {
  return getAllLabs().find(lab => lab.id === id)
}

export const getLabsByDifficulty = (difficulty: Difficulty): Lab[] => {
  return getAllLabs().filter(lab => lab.difficulty === difficulty)
}

export const getLabsByOwaspMapping = (owaspId: string): Lab[] => {
  return getAllLabs().filter(lab => lab.owaspMapping.includes(owaspId))
}

export const getLabsByCategory = (categoryId: string): Lab[] => {
  const category = labsDirectory.find(cat => cat.id === categoryId)
  return category?.labs || []
}

// Stats
export const labStats = {
  totalLabs: getAllLabs().length,
  freeLabs: getAllLabs().filter(lab => lab.isFree).length,
  byDifficulty: {
    beginner: getLabsByDifficulty('beginner').length,
    intermediate: getLabsByDifficulty('intermediate').length,
    advanced: getLabsByDifficulty('advanced').length,
    expert: getLabsByDifficulty('expert').length,
  },
  categories: labsDirectory.length,
}
